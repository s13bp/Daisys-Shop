{"ast":null,"code":"import _slicedToArray from\"/Users/crypto/Daisys/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/Users/crypto/Daisys/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/Users/crypto/Daisys/node_modules/@babel/runtime/regenerator/index.js\";import'./create.css';import Image from'../../assets/Image.png';import{useEffect,useState}from\"react\";import{create as ipfsHttpClient}from'ipfs-http-client';import{useMarketContract}from\"../../hooks/useMarketContract\";import{BigNumber,ethers}from\"ethers\";import CircleLoader from\"react-spinners/ClipLoader\";import{useContractKit}from\"@celo-tools/use-contractkit\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var client=ipfsHttpClient('https://ipfs.infura.io:5001/api/v0');var Create=function Create(){var _useContractKit=useContractKit(),address=_useContractKit.address,connect=_useContractKit.connect,performActions=_useContractKit.performActions;var navigate=useNavigate();useEffect(function(){if(!address){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return connect();case 2:case\"end\":return _context.stop();}}},_callee);}))();}},[address,connect]);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),price=_useState6[0],setPrice=_useState6[1];var _useState7=useState('Art'),_useState8=_slicedToArray(_useState7,2),category=_useState8[0],setCategory=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),name=_useState10[0],setName=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),description=_useState12[0],setDescription=_useState12[1];var marketplace=useMarketContract();var uploadToIPFS=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var file,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();file=event.target.files[0];if(!(typeof file!=='undefined')){_context2.next=14;break;}_context2.prev=3;_context2.next=6;return client.add(file);case 6:result=_context2.sent;console.log(result);setImage(\"https://ipfs.infura.io/ipfs/\".concat(result.path));_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](3);console.log(\"ipfs image upload error: \",_context2.t0);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[3,11]]);}));return function uploadToIPFS(_x){return _ref2.apply(this,arguments);};}();var isFormFiled=function isFormFiled(){if(image===''||price===null||category===''||name===''||description===''){return false;}else{return true;}};var createNFT=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:e.preventDefault();_context4.prev=1;_context4.next=4;return performActions(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(kit){var defaultAccount,result;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:defaultAccount=kit.defaultAccount;if(!(!image||!price||!name||!description||!category)){_context3.next=3;break;}return _context3.abrupt(\"return\");case 3:setLoading(true);_context3.next=6;return client.add(JSON.stringify({image:image,price:price,name:name,description:description,category:category,owner:address}));case 6:result=_context3.sent;_context3.next=9;return mintThenList(result,defaultAccount);case 9:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref4.apply(this,arguments);};}());case 4:_context4.next=9;break;case 6:_context4.prev=6;_context4.t0=_context4[\"catch\"](1);console.log(\"ipfs uri upload error: \",_context4.t0);case 9:_context4.prev=9;setLoading(false);return _context4.finish(9);case 12:case\"end\":return _context4.stop();}}},_callee4,null,[[1,6,9,12]]);}));return function createNFT(_x2){return _ref3.apply(this,arguments);};}();var mintThenList=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(result,defaultAccount){var uri,listingPrice,tx;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:uri=\"https://ipfs.infura.io/ipfs/\".concat(result.path);listingPrice=ethers.utils.parseEther(price.toString());// mint nft\n_context5.next=4;return marketplace.methods.createToken(uri,listingPrice).send({from:defaultAccount});case 4:tx=_context5.sent;alert(\"Your nft was minted successfully!\");navigate(\"/\");case 7:case\"end\":return _context5.stop();}}},_callee5);}));return function mintThenList(_x4,_x5){return _ref5.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"create section__padding\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"create-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Labs\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"writeForm\",autoComplete:\"off\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"formGroup\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Select Art\"}),/*#__PURE__*/_jsx(\"input\",{onChange:uploadToIPFS,type:\"file\",className:\"custom-file-input\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"formGroup\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"NAME\"}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setName(e.target.value);},type:\"text\",placeholder:\"Item Name\",autoFocus:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"formGroup\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"BIO\"}),/*#__PURE__*/_jsx(\"textarea\",{onChange:function onChange(e){return setDescription(e.target.value);},type:\"text\",rows:4,placeholder:\"Brief Info of your creation\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"formGroup\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Price\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"twoForm\",children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setPrice(e.target.value);},type:\"text\",placeholder:\"Price\"}),/*#__PURE__*/_jsx(\"select\",{children:/*#__PURE__*/_jsx(\"option\",{value:\"CELO\",children:\"CELO\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"formGroup\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Category\"}),/*#__PURE__*/_jsxs(\"select\",{onChange:function onChange(e){console.log(e.target.value);setCategory(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{children:\"Art\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Photography\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Sports\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Collectibles\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Trading Cards\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Utility\"})]})]}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"tw-text-center\",children:/*#__PURE__*/_jsx(CircleLoader,{color:\"white\"})}):/*#__PURE__*/_jsx(\"button\",{disabled:!isFormFiled(),className:\"writeButton\",onClick:createNFT,children:\"Create Item\"})]})]})});};export default Create;","map":{"version":3,"sources":["/Users/crypto/Daisys/src/pages/create/Create.jsx"],"names":["Image","useEffect","useState","create","ipfsHttpClient","useMarketContract","BigNumber","ethers","CircleLoader","useContractKit","useNavigate","client","Create","address","connect","performActions","navigate","loading","setLoading","image","setImage","price","setPrice","category","setCategory","name","setName","description","setDescription","marketplace","uploadToIPFS","event","preventDefault","file","target","files","add","result","console","log","path","isFormFiled","createNFT","e","kit","defaultAccount","JSON","stringify","owner","mintThenList","uri","listingPrice","utils","parseEther","toString","methods","createToken","send","from","tx","alert","value"],"mappings":"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","sourcesContent":["import './create.css'\nimport Image from '../../assets/Image.png'\nimport {useEffect, useState} from \"react\";\nimport {create as ipfsHttpClient} from 'ipfs-http-client'\nimport {useMarketContract} from \"../../hooks/useMarketContract\";\nimport {BigNumber, ethers} from \"ethers\";\n\nimport CircleLoader from \"react-spinners/ClipLoader\";\nimport {useContractKit} from \"@celo-tools/use-contractkit\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst client = ipfsHttpClient('https://ipfs.infura.io:5001/api/v0')\nconst Create = () => {\n    const {address, connect, performActions} = useContractKit()\n    const navigate = useNavigate();\n    useEffect(() => {\n\n        if (!address) {\n\n            (async () => {\n                await connect()\n            })()\n\n        }\n\n    }, [address, connect])\n\n\n    const [loading, setLoading] = useState(false)\n    const [image, setImage] = useState('')\n    const [price, setPrice] = useState(null)\n    const [category, setCategory] = useState('Art')\n    const [name, setName] = useState('')\n    const [description, setDescription] = useState('')\n\n    const marketplace = useMarketContract()\n\n\n    const uploadToIPFS = async (event) => {\n        event.preventDefault()\n        const file = event.target.files[0]\n        if (typeof file !== 'undefined') {\n            try {\n                const result = await client.add(file)\n                console.log(result)\n                setImage(`https://ipfs.infura.io/ipfs/${result.path}`)\n            } catch (error) {\n                console.log(\"ipfs image upload error: \", error)\n            }\n        }\n    }\n\n    const isFormFiled = () => {\n        if (image === '' || price === null || category === '' || name === '' || description === '') {\n            return false\n        } else {\n            return true\n        }\n    }\n    const createNFT = async (e) => {\n        e.preventDefault()\n        try {\n            await performActions(async (kit) => {\n                const {defaultAccount} = kit;\n\n                if (!image || !price || !name || !description || !category) return\n\n                setLoading(true)\n                const result = await client.add(JSON.stringify({image, price, name, description, category, owner : address}))\n                await mintThenList(result, defaultAccount)\n\n            })\n\n        } catch (error) {\n            console.log(\"ipfs uri upload error: \", error)\n        } finally {\n            setLoading(false)\n        }\n    }\n    const mintThenList = async (result, defaultAccount) => {\n        const uri = `https://ipfs.infura.io/ipfs/${result.path}`\n\n\n        const listingPrice = ethers.utils.parseEther(price.toString())\n\n\n        // mint nft\n       const tx =  await marketplace.methods.createToken(uri,listingPrice ).send({\n            from:defaultAccount\n        })\n\n\n        alert(\"Your nft was minted successfully!\")\n        navigate(`/`);\n\n    }\n\n    return (\n        <div className='create section__padding'>\n            <div className=\"create-container\">\n                <h1>Labs</h1>\n              \n              \n                <form className='writeForm' autoComplete='off'>\n\n                    <div className=\"formGroup\">\n                        <label>Select Art</label>\n                        <input onChange={uploadToIPFS} type=\"file\" className='custom-file-input'\n                        />\n                    </div>\n                    <div className=\"formGroup\">\n                        <label>NAME</label>\n                        <input onChange={(e) => setName(e.target.value)} type=\"text\" placeholder='Item Name'\n                               autoFocus={true}/>\n                    </div>\n                    <div className=\"formGroup\">\n                        <label>BIO</label>\n                        <textarea onChange={(e) => setDescription(e.target.value)} type=\"text\" rows={4}\n                                  placeholder='Brief Info of your creation'\n                        ></textarea>\n                    </div>\n                    <div className=\"formGroup\">\n                        <label>Price</label>\n                        <div className=\"twoForm\">\n                            <input onChange={(e) => setPrice(e.target.value)} type=\"text\" placeholder='Price'/>\n                            <select>\n                                <option value=\"CELO\">CELO</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div className=\"formGroup\">\n                        <label>Category</label>\n                        <select onChange={(e) => {\n                            console.log(e.target.value)\n                            setCategory(e.target.value)\n                        }}>\n                            <option>Art</option>\n                            <option>Photography</option>\n                            <option>Sports</option>\n                            <option>Collectibles</option>\n                            <option>Trading Cards</option>\n                            <option>Utility</option>\n                        </select>\n                    </div>\n                    {loading ?\n                        <div className={\"tw-text-center\"}>\n                            <CircleLoader color={\"white\"}/>\n                        </div>\n\n                        :\n                        <button disabled={!isFormFiled()} className='writeButton' onClick={createNFT}>Create\n                            Item</button>\n                    }\n\n\n                </form>\n            </div>\n        </div>\n\n    )\n};\n\nexport default Create;\n"]},"metadata":{},"sourceType":"module"}