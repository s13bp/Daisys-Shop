{"ast":null,"code":"import _asyncToGenerator from\"/Users/crypto/Daisys/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/crypto/Daisys/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/crypto/Daisys/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState}from'react';import'./profile.css';import profile_banner from'../../assets/profile_banner.png';import Nfts from'../../components/nfts/Nfts';import{useContractKit}from\"@celo-tools/use-contractkit\";import{useMarketContract}from\"../../hooks/useMarketContract\";import axios from\"axios\";import{ethers}from\"ethers\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Profile=function Profile(){var _useContractKit=useContractKit(),address=_useContractKit.address,connect=_useContractKit.connect,performActions=_useContractKit.performActions;var marketplace=useMarketContract();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),nfts=_useState2[0],setNfts=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),soldNfts=_useState4[0],setSoldNfts=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];useEffect(function(){if(marketplace){loadNFTs();}},[marketplace]);var loadNFTs=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var data,items;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoading(true);_context2.prev=1;_context2.next=4;return marketplace.methods.fetchMyNFTs().call();case 4:data=_context2.sent;console.log({data:data});_context2.next=8;return Promise.all(data.map(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(i){var tokenURI,owner,meta,price;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return marketplace.methods.tokenURI(i.tokenId).call();case 2:tokenURI=_context.sent;_context.next=5;return marketplace.methods.getNftOwner(i.tokenId).call();case 5:owner=_context.sent;_context.next=8;return axios.get(tokenURI);case 8:meta=_context.sent;price=ethers.utils.formatUnits(i.price.toString(),'ether');return _context.abrupt(\"return\",{price:price,tokenId:Number(i.tokenId),seller:i.seller,name:meta.data.name,owner:owner,image:meta.data.image,tokenURI:tokenURI});case 11:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}()));case 8:items=_context2.sent;setNfts(items);_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](1);console.log({e:_context2.t0});case 15:_context2.prev=15;setLoading(false);return _context2.finish(15);case 18:case\"end\":return _context2.stop();}}},_callee2,null,[[1,12,15,18]]);}));return function loadNFTs(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"profile section__padding\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-top\"}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-bottom\",children:/*#__PURE__*/_jsx(Nfts,{nfts:nfts,loading:loading,title:\"Your NFTs\",relist:true})})]});};export default Profile;","map":{"version":3,"sources":["/Users/crypto/Daisys/src/pages/profile/Profile.jsx"],"names":["React","useEffect","useState","profile_banner","Nfts","useContractKit","useMarketContract","axios","ethers","Profile","address","connect","performActions","marketplace","nfts","setNfts","soldNfts","setSoldNfts","loading","setLoading","loadNFTs","methods","fetchMyNFTs","call","data","console","log","Promise","all","map","i","tokenURI","tokenId","getNftOwner","owner","get","meta","price","utils","formatUnits","toString","Number","seller","name","image","items","e"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport './profile.css'\nimport profile_banner from '../../assets/profile_banner.png'\nimport Nfts from '../../components/nfts/Nfts'\nimport {useContractKit} from \"@celo-tools/use-contractkit\";\nimport {useMarketContract} from \"../../hooks/useMarketContract\";\nimport axios from \"axios\";\nimport {ethers} from \"ethers\";\n\nconst Profile = () => {\n\n    const {address, connect, performActions} = useContractKit()\n    const marketplace = useMarketContract()\n\n\n    const [nfts, setNfts] = useState([]);\n    const [soldNfts, setSoldNfts] = useState([]);\n    const [loading, setLoading] = useState(false);\n\n    useEffect(() => {\n        if (marketplace) {\n            loadNFTs()\n        }\n    }, [ marketplace]);\n\n    const loadNFTs = async () => {\n        setLoading(true)\n        try {\n            const data = await marketplace.methods.fetchMyNFTs().call()\n            console.log({data})\n            const items = await Promise.all(data.map(async i => {\n                const tokenURI = await marketplace.methods.tokenURI(i.tokenId).call()\n\n                const owner = await marketplace.methods.getNftOwner(i.tokenId).call()\n                const meta = await axios.get(tokenURI)\n                let price = ethers.utils.formatUnits(i.price.toString(), 'ether')\n\n                return {\n                    price,\n                    tokenId: Number(i.tokenId),\n                    seller: i.seller,\n                    name: meta.data.name,\n                    owner,\n                    image: meta.data.image,\n                    tokenURI\n                }\n            }))\n\n            setNfts(items)\n        } catch (e) {\n            console.log({e})\n        } finally {\n            setLoading(false)\n        }\n\n\n    }\n\n\n    return (\n        <div className='profile section__padding'>\n            <div className=\"profile-top\">\n               \n            </div>\n            <div className=\"profile-bottom\">\n     \n                <Nfts nfts={nfts} loading={loading} title=\"Your NFTs\" relist={true}/>\n            </div>\n        </div>\n    );\n};\n\nexport default Profile;\n"]},"metadata":{},"sourceType":"module"}