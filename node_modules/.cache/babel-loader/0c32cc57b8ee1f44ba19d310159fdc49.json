{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar _a;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ContractKitProvider = exports.ContextProvider = exports.useContractKitContext = void 0;\n\nvar contractkit_1 = require(\"@celo/contractkit\");\n\nvar react_1 = __importStar(require(\"react\"));\n\nvar connectors_1 = require(\"./connectors\");\n\nvar constants_1 = require(\"./constants\");\n\nvar contract_kit_reducer_1 = require(\"./contract-kit-reducer\");\n\nvar modals_1 = require(\"./modals\");\n\nvar use_contract_kit_methods_1 = require(\"./use-contract-kit-methods\");\n\nvar helpers_1 = require(\"./utils/helpers\");\n\nvar useIsMounted_1 = require(\"./utils/useIsMounted\");\n\nvar initialState = {\n  connector: new connectors_1.UnauthenticatedConnector(constants_1.Mainnet),\n  connectorInitError: null,\n  dapp: {\n    name: 'Celo dApp',\n    description: 'Celo dApp',\n    url: 'https://celo.org',\n    icon: 'https://celo.org/favicon.ico'\n  },\n  network: constants_1.Mainnet,\n  networks: constants_1.DEFAULT_NETWORKS,\n  pendingActionCount: 0,\n  address: null,\n  connectionCallback: null,\n  feeCurrency: contractkit_1.CeloContract.GoldToken\n};\nexports.useContractKitContext = (_a = __read(createContractKitContext(), 2), _a[0]), exports.ContextProvider = _a[1]; // This makes it so we don't have to provide defaults for our context\n// and also so that if our hooks are used outside of the Provider it\n// will throw an error.\n\nfunction createContractKitContext() {\n  var contractKitContext = react_1.default.createContext(undefined);\n\n  var useCtx = function () {\n    var c = react_1.default.useContext(contractKitContext);\n    if (!c) throw new Error('Components using the use-contractkit hook must be a child of a ContractKitProvider');\n    return c;\n  };\n\n  return [useCtx, contractKitContext.Provider];\n}\n\nvar ContractKitProvider = function (_a) {\n  var _b;\n\n  var children = _a.children,\n      connectModal = _a.connectModal,\n      actionModal = _a.actionModal,\n      dapp = _a.dapp,\n      _c = _a.network,\n      network = _c === void 0 ? constants_1.Mainnet : _c,\n      _d = _a.networks,\n      networks = _d === void 0 ? constants_1.DEFAULT_NETWORKS : _d,\n      _e = _a.feeCurrency,\n      feeCurrency = _e === void 0 ? contractkit_1.CeloContract.GoldToken : _e;\n  var isMountedRef = (0, useIsMounted_1.useIsMounted)();\n  var previousConfig = (0, react_1.useMemo)(function () {\n    return (0, helpers_1.loadPreviousConfig)(network, feeCurrency);\n  }, // We only want this to run on mount so the deps array is empty.\n\n  /* eslint-disable-next-line */\n  []);\n\n  var _f = __read((0, react_1.useReducer)(contract_kit_reducer_1.contractKitReducer, __assign(__assign(__assign({}, initialState), previousConfig), {\n    network: previousConfig.network || network,\n    feeCurrency: previousConfig.feeCurrency || feeCurrency,\n    networks: networks,\n    dapp: __assign(__assign({}, dapp), {\n      icon: (_b = dapp.icon) !== null && _b !== void 0 ? _b : \"\".concat(dapp.url, \"/favicon.ico\")\n    })\n  })), 2),\n      state = _f[0],\n      _dispatch = _f[1];\n\n  var dispatch = (0, react_1.useCallback)(function (type) {\n    var payload = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      payload[_i - 1] = arguments[_i];\n    }\n\n    if (isMountedRef.current) {\n      _dispatch({\n        type: type,\n        payload: payload[0]\n      });\n    }\n  }, [isMountedRef]);\n  var methods = (0, use_contract_kit_methods_1.useContractKitMethods)(state, dispatch);\n  (0, react_1.useEffect)(function () {\n    if (connectors_1.CONNECTOR_TYPES[state.connector.type] !== connectors_1.UnauthenticatedConnector) {\n      methods.initConnector(state.connector).catch(function () {\n        // If the connector fails to initialise on mount then we reset.\n        dispatch('destroy');\n      });\n    } // We only want this to run on mount so the deps array is empty.\n\n    /* eslint-disable-next-line */\n\n  }, []);\n  return react_1.default.createElement(exports.ContextProvider, {\n    value: [state, dispatch, methods]\n  }, react_1.default.createElement(modals_1.ConnectModal, __assign({}, connectModal)), react_1.default.createElement(modals_1.ActionModal, __assign({}, actionModal)), children);\n};\n\nexports.ContractKitProvider = ContractKitProvider;","map":{"version":3,"mappings":"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","names":["initialState","connector","connectors_1","constants_1","connectorInitError","dapp","name","description","url","icon","network","networks","pendingActionCount","address","connectionCallback","feeCurrency","contractkit_1","GoldToken","exports","_a","createContractKitContext","contractKitContext","react_1","createContext","undefined","useCtx","c","useContext","Error","Provider","ContractKitProvider","children","connectModal","actionModal","_c","_d","_e","isMountedRef","previousConfig","contract_kit_reducer_1","__assign","_b","state","_dispatch","dispatch","type","payload","current","methods","initConnector","catch","value","modals_1"],"sourceRoot":"","sources":["../src/contract-kit-provider.tsx"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}