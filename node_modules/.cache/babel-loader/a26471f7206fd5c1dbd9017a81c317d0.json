{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function get() {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) {\n    if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  }\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SignatureUtils = exports.guessSigner = exports.verifyEIP712TypedDataSigner = exports.recoverEIP712TypedDataSignerVrs = exports.recoverEIP712TypedDataSignerRsv = exports.parseSignatureWithoutPrefix = exports.parseSignature = exports.verifySignature = exports.signMessageWithoutPrefix = exports.signMessage = exports.signedMessageToPublicKey = exports.LocalSigner = exports.addressToPublicKey = exports.hashMessage = exports.hashMessageWithPrefix = exports.serializeSignature = exports.POP_SIZE = exports.NativeSigner = void 0;\n\nvar signatureUtils_1 = require(\"@celo/base/lib/signatureUtils\");\n\nvar Web3Utils = __importStar(require(\"web3-utils\"));\n\nvar address_1 = require(\"./address\");\n\nvar sign_typed_data_utils_1 = require(\"./sign-typed-data-utils\"); // Exports moved to @celo/base, forwarding them\n// here for backwards compatibility\n\n\nvar signatureUtils_2 = require(\"@celo/base/lib/signatureUtils\");\n\nObject.defineProperty(exports, \"NativeSigner\", {\n  enumerable: true,\n  get: function get() {\n    return signatureUtils_2.NativeSigner;\n  }\n});\nObject.defineProperty(exports, \"POP_SIZE\", {\n  enumerable: true,\n  get: function get() {\n    return signatureUtils_2.POP_SIZE;\n  }\n});\nObject.defineProperty(exports, \"serializeSignature\", {\n  enumerable: true,\n  get: function get() {\n    return signatureUtils_2.serializeSignature;\n  }\n});\n\nvar ethjsutil = require('ethereumjs-util'); // If messages is a hex, the length of it should be the number of bytes\n\n\nfunction messageLength(message) {\n  if (Web3Utils.isHexStrict(message)) {\n    return (message.length - 2) / 2;\n  }\n\n  return message.length;\n} // Ethereum has a special signature format that requires a prefix\n// https://github.com/ethereum/wiki/wiki/JSON-RPC#eth_sign\n\n\nfunction hashMessageWithPrefix(message) {\n  var prefix = '\\x19Ethereum Signed Message:\\n' + messageLength(message);\n  return Web3Utils.soliditySha3(prefix, message);\n}\n\nexports.hashMessageWithPrefix = hashMessageWithPrefix;\n\nfunction hashMessage(message) {\n  return Web3Utils.soliditySha3({\n    type: 'string',\n    value: message\n  });\n}\n\nexports.hashMessage = hashMessage;\n\nfunction addressToPublicKey(signer, signFn) {\n  return __awaiter(this, void 0, void 0, function () {\n    var msg, data, sig, rawsig, prefixedMsg, pubKey, computedAddr;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          msg = Buffer.from('dummy_msg_data');\n          data = '0x' + msg.toString('hex');\n          return [4\n          /*yield*/\n          , signFn(data, signer)];\n\n        case 1:\n          sig = _a.sent();\n          rawsig = ethjsutil.fromRpcSig(sig);\n          prefixedMsg = hashMessageWithPrefix(data);\n          pubKey = ethjsutil.ecrecover(Buffer.from(prefixedMsg.slice(2), 'hex'), rawsig.v, rawsig.r, rawsig.s);\n          computedAddr = ethjsutil.pubToAddress(pubKey).toString('hex');\n\n          if (!(0, address_1.eqAddress)(computedAddr, signer)) {\n            throw new Error('computed address !== signer');\n          }\n\n          return [2\n          /*return*/\n          , '0x' + pubKey.toString('hex')];\n      }\n    });\n  });\n}\n\nexports.addressToPublicKey = addressToPublicKey;\n\nfunction LocalSigner(privateKey) {\n  var _this = this;\n\n  return {\n    sign: function sign(message) {\n      return __awaiter(_this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n          return [2\n          /*return*/\n          , Promise.resolve((0, signatureUtils_1.serializeSignature)(signMessage(message, privateKey, (0, address_1.privateKeyToAddress)(privateKey))))];\n        });\n      });\n    }\n  };\n}\n\nexports.LocalSigner = LocalSigner;\n\nfunction signedMessageToPublicKey(message, v, r, s) {\n  var pubKeyBuf = ethjsutil.ecrecover(Buffer.from(message.slice(2), 'hex'), v, Buffer.from(r.slice(2), 'hex'), Buffer.from(s.slice(2), 'hex'));\n  return '0x' + pubKeyBuf.toString('hex');\n}\n\nexports.signedMessageToPublicKey = signedMessageToPublicKey;\n\nfunction signMessage(message, privateKey, address) {\n  return signMessageWithoutPrefix(hashMessageWithPrefix(message), (0, address_1.ensureLeading0x)(privateKey), address);\n}\n\nexports.signMessage = signMessage;\n\nfunction signMessageWithoutPrefix(messageHash, privateKey, address) {\n  var publicKey = ethjsutil.privateToPublic(ethjsutil.toBuffer(privateKey));\n  var derivedAddress = ethjsutil.bufferToHex(ethjsutil.pubToAddress(publicKey));\n\n  if (derivedAddress.toLowerCase() !== address.toLowerCase()) {\n    throw new Error('Provided private key does not match address of intended signer');\n  }\n\n  var _a = ethjsutil.ecsign(ethjsutil.toBuffer(messageHash), ethjsutil.toBuffer(privateKey)),\n      r = _a.r,\n      s = _a.s,\n      v = _a.v;\n\n  if (!isValidSignature(address, messageHash, v, ethjsutil.bufferToHex(r), ethjsutil.bufferToHex(s))) {\n    throw new Error('Unable to validate signature');\n  }\n\n  return {\n    v: v,\n    r: ethjsutil.bufferToHex(r),\n    s: ethjsutil.bufferToHex(s)\n  };\n}\n\nexports.signMessageWithoutPrefix = signMessageWithoutPrefix;\n\nfunction verifySignature(message, signature, signer) {\n  try {\n    parseSignature(message, signature, signer);\n    return true;\n  } catch (error) {\n    return false;\n  }\n}\n\nexports.verifySignature = verifySignature;\n\nfunction parseSignature(message, signature, signer) {\n  return parseSignatureWithoutPrefix(hashMessageWithPrefix(message), signature, signer);\n}\n\nexports.parseSignature = parseSignature;\n\nfunction parseSignatureWithoutPrefix(messageHash, signature, signer) {\n  var _a;\n\n  var _b = parseSignatureAsRsv(signature.slice(2)),\n      r = _b.r,\n      s = _b.s,\n      v = _b.v;\n\n  if (isValidSignature(signer, messageHash, v, r, s)) {\n    return {\n      v: v,\n      r: r,\n      s: s\n    };\n  }\n\n  ;\n  _a = parseSignatureAsVrs(signature.slice(2)), r = _a.r, s = _a.s, v = _a.v;\n\n  if (isValidSignature(signer, messageHash, v, r, s)) {\n    return {\n      v: v,\n      r: r,\n      s: s\n    };\n  }\n\n  throw new Error(\"Unable to parse signature (expected signer \" + signer + \")\");\n}\n\nexports.parseSignatureWithoutPrefix = parseSignatureWithoutPrefix;\n\nfunction recoverEIP712TypedDataSigner(typedData, signature, parseFunction) {\n  var dataBuff = (0, sign_typed_data_utils_1.generateTypedDataHash)(typedData);\n\n  var _a = parseFunction((0, address_1.trimLeading0x)(signature)),\n      r = _a.r,\n      s = _a.s,\n      v = _a.v;\n\n  var publicKey = ethjsutil.ecrecover(ethjsutil.toBuffer(dataBuff), v, ethjsutil.toBuffer(r), ethjsutil.toBuffer(s)); // TODO test error handling on this\n\n  return ethjsutil.bufferToHex(ethjsutil.pubToAddress(publicKey));\n}\n/**\n * Recover signer from RSV-serialized signature over signed typed data.\n * @param typedData EIP712 typed data\n * @param signature RSV signature of signed type data by signer\n * @returns string signer, or throws error if parsing fails\n */\n\n\nfunction recoverEIP712TypedDataSignerRsv(typedData, signature) {\n  return recoverEIP712TypedDataSigner(typedData, signature, parseSignatureAsRsv);\n}\n\nexports.recoverEIP712TypedDataSignerRsv = recoverEIP712TypedDataSignerRsv;\n/**\n * Recover signer from VRS-serialized signature over signed typed data.\n * @param typedData EIP712 typed data\n * @param signature VRS signature of signed type data by signer\n * @returns string signer, or throws error if parsing fails\n */\n\nfunction recoverEIP712TypedDataSignerVrs(typedData, signature) {\n  return recoverEIP712TypedDataSigner(typedData, signature, parseSignatureAsVrs);\n}\n\nexports.recoverEIP712TypedDataSignerVrs = recoverEIP712TypedDataSignerVrs;\n/**\n * @param typedData EIP712 typed data\n * @param signature VRS or SRV signature of `typedData` by `signer`\n * @param signer address to verify signed the `typedData`\n * @returns boolean, true if `signer` is a possible signer of `signature`\n */\n\nfunction verifyEIP712TypedDataSigner(typedData, signature, signer) {\n  var e_1, _a;\n\n  try {\n    for (var _b = __values([recoverEIP712TypedDataSignerVrs, recoverEIP712TypedDataSignerRsv]), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var recover = _c.value;\n\n      try {\n        if ((0, address_1.eqAddress)(recover(typedData, signature), signer)) {\n          return true;\n        }\n      } catch (e) {// try both serialization formats before failing to verify\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return false;\n}\n\nexports.verifyEIP712TypedDataSigner = verifyEIP712TypedDataSigner;\n\nfunction guessSigner(message, signature) {\n  var messageHash = hashMessageWithPrefix(message);\n\n  var _a = parseSignatureAsRsv(signature.slice(2)),\n      r = _a.r,\n      s = _a.s,\n      v = _a.v;\n\n  var publicKey = ethjsutil.ecrecover(ethjsutil.toBuffer(messageHash), v, ethjsutil.toBuffer(r), ethjsutil.toBuffer(s));\n  return ethjsutil.bufferToHex(ethjsutil.pubToAddress(publicKey));\n}\n\nexports.guessSigner = guessSigner;\n\nfunction parseSignatureAsVrs(signature) {\n  var v = parseInt(signature.slice(0, 2), 16);\n  var r = \"0x\" + signature.slice(2, 66);\n  var s = \"0x\" + signature.slice(66, 130);\n\n  if (v < 27) {\n    v += 27;\n  }\n\n  return {\n    v: v,\n    r: r,\n    s: s\n  };\n}\n\nfunction parseSignatureAsRsv(signature) {\n  var r = \"0x\" + signature.slice(0, 64);\n  var s = \"0x\" + signature.slice(64, 128);\n  var v = parseInt(signature.slice(128, 130), 16);\n\n  if (v < 27) {\n    v += 27;\n  }\n\n  return {\n    r: r,\n    s: s,\n    v: v\n  };\n}\n\nfunction isValidSignature(signer, message, v, r, s) {\n  try {\n    var publicKey = ethjsutil.ecrecover(ethjsutil.toBuffer(message), v, ethjsutil.toBuffer(r), ethjsutil.toBuffer(s));\n    var retrievedAddress = ethjsutil.bufferToHex(ethjsutil.pubToAddress(publicKey));\n    return (0, address_1.eqAddress)(retrievedAddress, signer);\n  } catch (err) {\n    return false;\n  }\n}\n\nexports.SignatureUtils = {\n  NativeSigner: signatureUtils_1.NativeSigner,\n  LocalSigner: LocalSigner,\n  signMessage: signMessage,\n  signMessageWithoutPrefix: signMessageWithoutPrefix,\n  parseSignature: parseSignature,\n  parseSignatureWithoutPrefix: parseSignatureWithoutPrefix,\n  serializeSignature: signatureUtils_1.serializeSignature,\n  recoverEIP712TypedDataSignerRsv: recoverEIP712TypedDataSignerRsv,\n  recoverEIP712TypedDataSignerVrs: recoverEIP712TypedDataSignerVrs,\n  verifyEIP712TypedDataSigner: verifyEIP712TypedDataSigner\n};","map":{"version":3,"mappings":"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","names":["Object","enumerable","get","ethjsutil","require","messageLength","message","Web3Utils","isHexStrict","length","hashMessageWithPrefix","prefix","soliditySha3","exports","hashMessage","type","value","addressToPublicKey","signer","signFn","msg","Buffer","from","data","toString","sig","_a","rawsig","fromRpcSig","prefixedMsg","pubKey","ecrecover","slice","v","r","s","computedAddr","pubToAddress","Error","LocalSigner","privateKey","sign","resolve","signMessage","signedMessageToPublicKey","pubKeyBuf","address","signMessageWithoutPrefix","messageHash","publicKey","privateToPublic","toBuffer","derivedAddress","bufferToHex","toLowerCase","ecsign","isValidSignature","verifySignature","signature","parseSignature","error","parseSignatureWithoutPrefix","parseSignatureAsRsv","parseSignatureAsVrs","recoverEIP712TypedDataSigner","typedData","parseFunction","dataBuff","recoverEIP712TypedDataSignerRsv","recoverEIP712TypedDataSignerVrs","verifyEIP712TypedDataSigner","_c","recover","e","guessSigner","parseInt","retrievedAddress","err","NativeSigner","serializeSignature"],"sourceRoot":"","sources":["../src/signatureUtils.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}